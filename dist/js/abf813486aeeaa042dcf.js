(window.webpackJsonp=window.webpackJsonp||[]).push([["main"],{JwtI:function(e,t,a){"use strict";a.r(t);a("rMck"),a("ajHv");var n,o=a("ERkP"),l=a.n(o),i=a("7nmT"),r=a.n(i),c=a("0acT"),s=a("5qKm"),d=a("jtiS"),m=a("TQen"),p=a("Udmz"),u=a("H8PI"),b=a("8MrD");!function(e){e[e.Default=0]="Default",e[e.User=1]="User"}(n||(n={}));var g=a("8dj6"),f=a("fPKC"),v=a("pIRP"),h=a("8G6N");const x="EcsConfig",E=(()=>{try{return JSON.parse(localStorage.getItem(x)||"{}")}catch(e){return{}}})(),y=Object.assign(Object.assign({},{NPSFeedbackEnabledTimeRange:"",FeedbackBubbleEnabledTimeRange:"2024-09-18/2024-10-10"}),E);const N=new d.QueryClient({defaultOptions:{queries:{staleTime:1/0,cacheTime:1/0}}}),k=l.a.createContext({data:y});function O({children:e,defaultValue:t,value:a}){const n=b.o.get(b.k.UserId),o=b.o.get(b.k.TenantId),i=b.o.get(b.k.RingId),r=b.o.get(b.k.ClientType),s=Object(c.o)(),m=function(e){if(e)return{agents:"MWTWorkReport",ClientEnvironment:b.g,TeamsRing:e.ringId||"",HostClientType:e.hostClientType||"",TenantID:e.tid||"",UserID:e.userObjectId||""}}(Object.assign({userObjectId:n,tid:o,ringId:i,hostClientType:r},s)),p=Object(d.useQuery)(["GetECSConfigs",m],(()=>function(e){const t={params:e,_startRequestTime:performance.now()};return g.a.get(f.c,t).then((e=>{const t=Object(h.b)(e);return localStorage.setItem(x,JSON.stringify(t.MWTWorkReport)),t})).catch((e=>{var t;return v.f.logTraceError(v.a.ECSRequest,`EcsCallError ${null===(t=null==e?void 0:e.config)||void 0===t?void 0:t.url} ${e.message}`),{MWTWorkReport:y,Headers:{}}}))}(m)),{select:e=>e.MWTWorkReport,placeholderData:{MWTWorkReport:t||y,Headers:{}},enabled:!a&&!!m});return l.a.createElement(k.Provider,{value:a?{data:a}:p},e)}function j({children:e,defaultValue:t,value:a}){return l.a.createElement(d.QueryClientProvider,{client:N},l.a.createElement(O,{defaultValue:t,value:a},e))}a("2spY");var w,C=a("fQLH");!function(e){e.OnboardingModal="OnboardingModal",e.WriteBubble="WriteBubble",e.RequestBubble="RequestBubble",e.SubmitBubble="SubmitBubble",e.ReviewBubble="ReviewBubble",e.SubmitGuidesBubble="SubmitGuidesBubble",e.ReviewGuidesBubble="ReviewGuidesBubble",e.TaskModuleHomeBubble="TaskModuleHomeBubble",e.TaskModuleHomeSimpleFRE="TaskModuleHomeSimpleFRE",e.TaskModuleHomeSimplePreviewBubble="TaskModuleHomeSimplePreviewBubble",e.TaskModuleHomeSimpleRuleSettingsBubble="TaskModuleHomeSimpleRuleSettingsBubble",e.MobileSubmitBubble="MobileSubmitBubble",e.MobileReviewBubble="MobileReviewBubble",e.FeedbackInAppBubble="FeedbackInAppBubble",e.FeedbackInTaskModuleBubble="FeedbackInTaskModuleBubble"}(w||(w={}));w.WriteBubble,w.OnboardingModal,w.RequestBubble,w.WriteBubble,w.OnboardingModal,w.SubmitBubble,w.RequestBubble,w.OnboardingModal,w.SubmitGuidesBubble,w.SubmitBubble,w.OnboardingModal,w.ReviewBubble,w.RequestBubble,w.OnboardingModal,w.ReviewGuidesBubble,w.ReviewBubble,w.OnboardingModal,w.FeedbackInAppBubble,w.SubmitGuidesBubble,w.OnboardingModal,w.TaskModuleHomeBubble,w.OnboardingModal,w.MobileSubmitBubble,w.OnboardingModal,w.MobileReviewBubble,w.MobileSubmitBubble;a("VTGp");new C.a;var S;!function(e){e.Loading="loading",e.Error="error",e.Empty="empty",e.NonEmpty="nonEmpty"}(S||(S={}));var T,D=a("9hZ6"),F=(a("TktC"),a("+INc")),R=a("jFKp"),I=a("Favm"),M=a("xRnI"),L=a("Tr4L"),P=a("/5rm"),B=a("PNiH"),H=a("58+7"),z=a("5HKM"),A=a("ErM2"),W=a("wnJg"),$=a("HVbO"),q=a("MpLv");!function(e){e.noReport="noReport",e.noPermission="noPermission",e.newChat="newChat",e.guestUser="guestUser",e.solutionNotUpgrade="SolutionNotUpgrade",e.ReportDefinitionDisabled="ReportDefinitionDisabled",e.NotDefinitionSubmitter="NotDefinitionSubmitter",e.DefinitionReviewer="DefinitionReviewer",e.DefinitionOwner="DefinitionOwner",e.FormsResponseNotFound="FormsResponseNotFound",e.FormsPrincipalDisabled="FormsPrincipalDisabled",e.UserNotEnabled="UserNotEnabled",e.NotProvisioned="NotProvisioned",e.ExecutedSimilarManualReminderRecently="ExecutedSimilarManualReminderRecently",e.Retry="retry",e.EnvironmentNotFound="EnvironmentNotFound",e.ItemNotFound="ItemNotFound",e.BAPBatchAddUserFail="BAPBatchAddUserFail",e.MultiUserOperationConflict="MultiUserOperationConflict"}(T||(T={}));const G={[T.noReport]:P.a,[T.noPermission]:z.a,[T.newChat]:H.a,[T.guestUser]:z.a,[T.solutionNotUpgrade]:H.a,[T.ReportDefinitionDisabled]:B.a,[T.NotDefinitionSubmitter]:z.a,[T.FormsResponseNotFound]:W.a,[T.FormsPrincipalDisabled]:W.a,[T.NotProvisioned]:z.a,[q.a.network]:A.a,[q.a.teamsSDK]:A.a,[T.DefinitionReviewer]:P.a,[T.DefinitionOwner]:P.a,[T.ItemNotFound]:B.a,[T.MultiUserOperationConflict]:H.a},U=({img:e,title:t,message:a,actionText:n,onAction:o,className:i,error:r,errorCode:c,hideImg:s,onReturnToHome:d,children:m})=>{var p;const u=Object(R.a)(),{t:b}=Object(L.a)(),g=c||(null==r?void 0:r.code),f=s?"":e||G[g],h=(null==r?void 0:r.requestId)||`{${v.f.sessionId}}`,x=null!=n?n:o&&b($.a.errorAction,{context:g}),E=g===T.MultiUserOperationConflict;return l.a.useEffect((()=>{!r||r instanceof q.b||v.f.logTraceException(v.a.ErrorStatus,{error:r})}),[r,g]),r instanceof q.b&&!a&&(a=(null!==(p=r.detailedErrors)&&void 0!==p?p:[r]).map((e=>{var t,a,n;return b($.a.errorDescription,Object.assign({context:e.code,correlationId:h,count:null!==(n=null===(a=null===(t=e.additionalErrorMessage)||void 0===t?void 0:t.userNames)||void 0===a?void 0:a.length)&&void 0!==n?n:0},e.additionalErrorMessage))})).join("\n")),l.a.createElement(F.d,{image:f,role:"alert",title:null!=t?t:b($.a.errorTitle,{context:g}),message:a,actionText:x,height:"100%",background:"transparent",color:u.palette.black,className:`${i} empty-state`},l.a.createElement("div",{style:{display:"flex",justifyContent:"center",gap:"20px"}},x&&l.a.createElement(I.a,{text:x,onClick:o}),E&&d&&l.a.createElement(M.a,{text:b($.a.returnToHomePage),onClick:d})),m)};var V=a("n4Dn"),K=a("tPyQ"),Q=a("ZOo+"),_=a("apXe"),Y=a("NGG8"),J=a("uel9"),X=a("DDLe"),Z=a("v0/M"),ee=a("Mt8f"),te=a("YCKj");function ae(e){var t;return{id:e.id,key:e.id,mail:null!==(t=e.mail)&&void 0!==t?t:e.userPrincipalName,manager:void 0,name:e.displayName,officeLocation:e.officeLocation,phone:e.mobilePhone,role:e.jobTitle,parentDepartments:e.parentDepartments}}function ne(e){var t;return null!==(t=null==e?void 0:e.split("/").pop())&&void 0!==t?t:""}var oe=function(e,t,a,n){return new(a||(a=Promise))((function(o,l){function i(e){try{c(n.next(e))}catch(e){l(e)}}function r(e){try{c(n.throw(e))}catch(e){l(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(i,r)}c((n=n.apply(e,t||[])).next())}))};Object(V.a)((e=>({root:{width:"320px",maxHeight:"400px",display:"flex",flexDirection:"column"},primary:{display:"flex",alignItems:"center",gap:"16px",padding:"24px"},secondary:{flex:1,padding:"24px",borderTop:`1px solid ${Object(K.f)(e.name)?e.palette.black:e.palette.neutralLight}`,overflowY:"auto"},overview:{display:"flex",flexDirection:"column",gap:"4px"},name:{fontSize:Q.a.size14,fontWeight:700,lineHeight:Q.a.size20},badge:{padding:"2px 6px",borderRadius:"4px",backgroundColor:e.palette.themeLighter,border:Object(K.f)(e.name)?`1px solid ${e.palette.themePrimary}`:"none",color:e.palette.themePrimary},description:{fontSize:Q.a.size12,fontWeight:400}})));var le;function ie(e,t){return oe(this,void 0,void 0,(function*(){return function(e,t){return oe(this,void 0,void 0,(function*(){const a=e.type===_.b.User?te.f.users(e.id):e.type===_.b.Group?te.f.groups(e.id):void 0;if(a)try{return yield a.photos(64).download(t)}catch(e){return}}))}(e,t)}))}!function(e){e.overWriters="overWriters",e.overUser="overUser",e.overGroup="overGroup",e.overReceivers="overReceivers",e.overComanagers="overComanagers"}(le||(le={}));new Map([["",void 0],["4f197574-c487-4ab8-ac2e-c3584026d646",Y.a],["da3647a2-cdeb-4b72-a31d-f4a184d8e727",Z.a],["8af34f36-a407-4b16-9b7e-14dcea93fb09",void 0],["1a9ecbd6-05c1-42f1-ac1e-1534500be7d1",J.a],["ea126a6e-8e86-4401-8d5a-c168a8ee1e36",X.a],["da3c2255-d519-4ee2-a586-932f8b6d88af",ee.a]]);var re=a("k2tF");var ce=a("MeCZ");var se=a("eZeq"),de=a("ogYq"),me=a("Pn0s"),pe=a("fh99"),ue=a("KEG9"),be=a("Imro"),ge=a("hGA5");const fe=({items:e,columns:t,className:a,rowClass:n,queryStatus:o,ariaLabel:i,onItemClick:r,shimmerLines:c,onRenderRow:s,isHeaderVisible:d=!0,groupProps:m,groups:p,announcedMessage:u})=>{var b;const[g]=Object(ce.a)({loading:!!(null==o?void 0:o.isLoading),hasNextPage:!!(null==o?void 0:o.canLoadMore),onLoadMore:null!==(b=null==o?void 0:o.loadMore)&&void 0!==b?b:()=>{},disabled:!o,rootMargin:"0px 0px 200px 0px"}),f=l.a.useCallback((e=>e?l.a.createElement(se.a,Object.assign({},e,{className:Object(de.F)(n&&n(e)),"data-selection-invoke":!0,role:"row","data-testid":"DetailsRow","aria-rowindex":e.itemIndex})):l.a.createElement(l.a.Fragment,null)),[n]),v=l.a.useCallback((e=>e?l.a.createElement(l.a.Fragment,null,l.a.createElement(me.a,Object.assign({},e)),u&&l.a.createElement(pe.a,{message:u})):null),[u]);return l.a.createElement(ue.a,{selectionMode:be.c.none,constrainMode:ge.d.unconstrained,layoutMode:ge.e.justified,enableShimmer:!e,columns:t,items:((null==o?void 0:o.isLoading)||(null==o?void 0:o.canLoadMore))&&e?[...e,null]:e||[],isHeaderVisible:d,onRenderRow:null!=s?s:f,onItemInvoked:r&&(e=>r(e)),onRenderDetailsFooter:()=>l.a.createElement("div",{ref:g,style:{height:"30px"}}),className:a,ariaLabelForGrid:i,shimmerLines:c,role:"table",groups:p,groupProps:m,onRenderDetailsHeader:v})};var ve=a("HKfi");const he=({isMobile:e})=>{const t=Object(d.useIsFetching)()>0,a=!e&&window.location.pathname.indexOf(D.a.HomePage)>0;return l.a.createElement(l.a.Fragment,null,!a&&l.a.createElement(ve.a,{isFetching:t}))};var xe=a("Qy9N"),Ee=a("FGVm"),ye=a("RKR/"),Ne=a("q7qM");const ke=Object(V.a)((()=>({root:{img:{width:"200px",height:"200px",objectFit:"contain"},"&.is-small":{gap:"0 !important",img:{width:"100px",height:"100px"}},"> button":{flexShrink:0}}}))),Oe=({hyperText:e,img:t,title:a,message:n,actionText:i,onAction:r,className:c,isSmall:s,children:d,role:m})=>{const p=Object(R.a)(),u=ke(),b=Object(o.useMemo)((()=>"FileEmpty"===t?P.a:"Optimizing"===t?ye.a:"Submitted"===t?Ne.a:"NoUnsubmitted"===t?Ee.a:"NoMessage"===t?xe.a:""),[t]);return l.a.createElement(F.d,{role:m,className:Object(de.F)(u.root,s&&"is-small",c),image:b,title:null!=a?a:"",hyperText:e,message:n,height:"100%",background:"transparent",color:p.palette.black},i&&l.a.createElement(M.a,{text:i,onClick:r}),d)};var je=a("tZX7"),we=a("l3kg"),Ce=a("EO0U");const Se=Object(V.a)((e=>({root:{height:"100%",padding:"0 2em"},message:{fontSize:"1.2em",fontWeight:de.e.bold,color:e.palette.black,whiteSpace:"pre-line",textAlign:"center"}}))),Te=({message:e,className:t})=>{const{t:a,ready:n}=Object(L.a)("strings",{useSuspense:!1}),o=Se(),i=Object(Ce.a)("LoadingLabel");return l.a.useEffect((()=>{const e=setTimeout((()=>{v.f.logTraceError(v.a.LoadingTimeout,`${f.h} seconds loading timeout happens in page: ${window.location.href}`)}),1e3*f.h);return()=>clearTimeout(e)}),[]),l.a.createElement(je.a,{verticalFill:!0,verticalAlign:"center",horizontalAlign:"center",className:`${Object(de.F)(o.root,t)} loading-page`,role:"alert","aria-atomic":!0},l.a.createElement(F.e,{"aria-label":n?a($.a.loadingAriaLabel):"Loading","aria-describedby":e&&i}),e&&l.a.createElement(we.a,{id:i,className:o.message},e))};var De=a("dXTB"),Fe=a("KIfy"),Re=a("BFcr"),Ie=a("dERd");function Me(e){Object(c.f)(`${b.j}/l/chat/0/0?users=8:orgid:${e}`)}function Le(e){Object(c.f)(`${b.j}/l/call/0/0?users=8:orgid:${e}`)}const Pe=Object(V.a)((e=>({root:{fontSize:e.fonts.small.fontSize,display:"flex",gap:"12px",flexDirection:"column"},header:{display:"flex",flexDirection:"column",gap:"4px"},main:{display:"flex",flexDirection:"column",gap:"12px"},subHeaderText:{fontSize:e.fonts.medium.fontSize,fontWeight:"bold",color:e.palette.black},subHeader:{display:"flex",flexDirection:"row",gap:"2px",alignItems:"center"},presence:{display:"flex",flexDirection:"row",gap:"16px",alignItems:"center",padding:"12px 16px 12px 16px",border:Object(K.g)(e.name)?"1px solid #3D3D3D":"1px solid #F0F0F0"},ContractInfo:{display:"flex",flexDirection:"row",gap:"8px",alignItems:"center"},icon:{width:"20px",height:"20px",fontSize:"20px",bottom:"1px",color:e.palette.black,position:"relative",flexShrink:0},ManagerInfo:{},boldText:{fontSize:e.fonts.mediumPlus.fontSize,fontWeight:"bold",color:e.palette.black},peopleWithIcon:{display:"flex",flexDirection:"row",gap:"16px"},peopleWithPresenceInfo:{position:"relative",width:"64px",height:"64px"},presenceInfo:{position:"absolute",bottom:0,borderRadius:"100%",border:`2px solid ${e.palette.white}`,backgroundColor:e.palette.white,right:0,width:"20px",height:"20px"},info:{display:"flex",flexDirection:"column",gap:"4px"},quickHeader:{display:"flex",flexDirection:"row",gap:"20px"},callout:{width:340,padding:"20px 24px"},divider:{border:Object(K.g)(e.name)?"1px solid #3D3D3D":"1px solid #F0F0F0"},text:[Object(F.f)(1)]})));var Be=function(e,t,a,n){return new(a||(a=Promise))((function(o,l){function i(e){try{c(n.next(e))}catch(e){l(e)}}function r(e){try{c(n.throw(e))}catch(e){l(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(i,r)}c((n=n.apply(e,t||[])).next())}))};const He=({people:e,onDismiss:t,target:a,departmentMapping:n})=>{const o=Pe(),[i,r]=l.a.useState(void 0),[s,d]=l.a.useState(void 0),{t:m}=Object(L.a)();return l.a.useEffect((()=>{Be(void 0,void 0,void 0,(function*(){const t=yield function(e){return oe(this,void 0,void 0,(function*(){return yield te.f.users(e).getPresence()}))}(e.id);r(t)}))}),[e.id]),l.a.useEffect((()=>{Be(void 0,void 0,void 0,(function*(){const t=yield function(e){return oe(this,void 0,void 0,(function*(){return t=yield te.f.users(e).getManager(),{id:null!==(a=t.id)&&void 0!==a?a:"",key:null!==(n=t.id)&&void 0!==n?n:"",mail:null!==(l=null!==(o=t.mail)&&void 0!==o?o:t.userPrincipalName)&&void 0!==l?l:"",manager:void 0,name:null!==(i=t.displayName)&&void 0!==i?i:"",officeLocation:null!==(r=t.officeLocation)&&void 0!==r?r:"",phone:null!==(c=t.mobilePhone)&&void 0!==c?c:"",role:null!==(s=t.jobTitle)&&void 0!==s?s:"",parentDepartments:[]};var t,a,n,o,l,i,r,c,s}))}(e.id);d(t)}))}),[e.id]),l.a.createElement(De.a,{role:"dialog",className:o.callout,gapSpace:20,key:e.id,target:a,isBeakVisible:!1,onDismiss:t,setInitialFocus:!0},l.a.createElement("div",{className:o.root},l.a.createElement("div",{className:o.info},l.a.createElement("div",{className:o.peopleWithIcon},l.a.createElement("div",{className:o.peopleWithPresenceInfo},l.a.createElement(_.a,{selection:{id:e.id,name:e.name,type:0},onRetrieveIcon:ie,coinSize:64}),i&&l.a.createElement("div",{className:o.presenceInfo},l.a.createElement(Fe.a,{"aria-label":"Mail",iconName:Ie.a[i].name,className:Object(de.F)(o.icon,{color:Ie.a[i].color})}))),l.a.createElement("div",{className:o.info},l.a.createElement("span",{className:o.boldText},e.name),l.a.createElement("span",null,e.role),e.parentDepartments.map((e=>{var t;return l.a.createElement("span",null,ne(null===(t=n[e])||void 0===t?void 0:t.departmentFullName))})))),l.a.createElement("div",{className:o.quickHeader},l.a.createElement(Re.a,{iconProps:{iconName:"Chat",styles:{root:{fontSize:"20px"}}},title:"Chat",ariaLabel:"Chat",onClick:()=>Me(e.id)}),l.a.createElement(Re.a,{iconProps:{iconName:"Call",styles:{root:{fontSize:"20px",padding:0}}},title:"OpenCall",ariaLabel:"OpenCall",onClick:()=>Le(e.id)}),l.a.createElement(Re.a,{iconProps:{iconName:"Video",styles:{root:{fontSize:"20px"}}},title:"OpenVideoCall",ariaLabel:"OpenVideoCall",onClick:()=>{return t=e.id,void Object(c.f)(`${b.j}/l/call/0/0?users=8:orgid:${t}`);var t}})),l.a.createElement("div",{className:o.divider})),l.a.createElement("div",{className:o.main},i&&l.a.createElement("div",{className:o.presence},l.a.createElement(Fe.a,{"aria-label":"Mail",iconName:Ie.a[i].name,className:Object(de.F)(o.icon,{color:Ie.a[i].color})}),l.a.createElement("span",{className:o.subHeaderText},i)),(e.mail||e.phone||e.officeLocation)&&l.a.createElement("div",{className:o.subHeader},l.a.createElement("span",{className:o.subHeaderText},m($.a.contractLabel)),l.a.createElement(Fe.a,{"aria-label":"ChevronRight",iconName:"ChevronRight",className:o.icon})),e.mail&&l.a.createElement("div",{className:o.ContractInfo},l.a.createElement(Fe.a,{"aria-label":"Mail",iconName:"Mail",className:o.icon}),l.a.createElement("span",{className:o.text,title:e.mail},e.mail)),e.phone&&l.a.createElement("div",{className:o.ContractInfo},l.a.createElement(Fe.a,{"aria-label":"Call",iconName:"Call",className:o.icon}),l.a.createElement("span",{className:o.text},e.phone)),e.officeLocation&&l.a.createElement("div",{className:o.ContractInfo},l.a.createElement(Fe.a,{"aria-label":"Location",iconName:"Location",className:o.icon}),l.a.createElement("span",{className:o.text},e.officeLocation)),s&&l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{className:o.subHeader},l.a.createElement("span",{className:o.subHeaderText},m($.a.managerLabel)),l.a.createElement(Fe.a,{"aria-label":"ChevronRight",iconName:"ChevronRight",className:o.icon})),l.a.createElement("div",{className:o.peopleWithIcon},l.a.createElement("div",{className:o.info},l.a.createElement(_.a,{selection:{id:s.id,name:s.name,type:0},onRetrieveIcon:ie,coinSize:32})),l.a.createElement("div",null,l.a.createElement("span",{className:o.text,title:s.name},s.name),l.a.createElement("br",null),l.a.createElement("span",{className:o.text},s.role)))))))};var ze=function(e,t,a,n){return new(a||(a=Promise))((function(o,l){function i(e){try{c(n.next(e))}catch(e){l(e)}}function r(e){try{c(n.throw(e))}catch(e){l(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(i,r)}c((n=n.apply(e,t||[])).next())}))};const Ae=()=>{const{t:e}=Object(L.a)(),t=Object(u.i)(),{mutate:a,isSuccess:n,isLoading:o,error:i}=Object(d.useMutation)({mutationFn:()=>ze(void 0,void 0,void 0,(function*(){yield te.c.clearCache({})})),onSuccess:()=>{te.g.clear(),Object(te.e)(),te.g.invalidateQueries(),t(D.a.HomePage)}});return l.a.createElement(l.a.Fragment,null,l.a.createElement(Re.a,{iconProps:{iconName:"Refresh"},onClick:()=>{a()}}),o&&l.a.createElement("div",null,e($.a.refreshCacheLoading)),i&&l.a.createElement("div",null,e($.a.refreshCacheFailed,{error:i})))};var We=a("XgkO");const $e=Object(V.a)((e=>({inputField:{flex:1,".ms-Label":{padding:"0 0 4px",whiteSpace:"nowrap"},".ms-TextField-field":{paddingLeft:"36px",backgroundColor:e.palette.neutralLight,paddingRight:"36px"}},textFieldIcon1:{position:"absolute",left:"6px",top:"50%",transform:"translateY(-50%)",pointerEvents:"none"}}))),qe=({searchText:e})=>{const{t:t}=Object(L.a)(),[a,n]=Object(o.useState)(null!=e?e:""),i=Object(o.useCallback)(((e,t)=>{n(t||"")}),[]),r=$e(),c=Object(u.i)(),s={iconName:"Search",className:r.textFieldIcon1,styles:{root:{fontSize:"20px"}}};return l.a.createElement(l.a.Fragment,null,l.a.createElement("form",{noValidate:!0,autoComplete:"off"},l.a.createElement(We.a,{className:r.inputField,placeholder:t($.a.searchPlaceholder),iconProps:s,value:a,onChange:i,onKeyDown:e=>{"Enter"===e.key&&""!==a&&c(Object(D.b)(D.a.SearchResults,void 0,{searchText:a}))}})))},Ge=Object(V.a)((()=>({navContainer:{display:"flex",flexDirection:"row",gap:"4px",alignItems:"center"}}))),Ue=({items:e,farItems:t,title:a,moduleName:n,searchText:l})=>{const{t:i}=Object(L.a)(),r=Ge(),c=o.useMemo((()=>t||o.createElement("div",{className:r.navContainer},o.createElement(qe,{searchText:l}),o.createElement(Ae,null))),[t,l,r.navContainer]);return o.createElement(F.a,{title:void 0===a?i($.a.appName,{context:b.g}):a,items:e,farItems:c,moduleName:n})};var Ve=a("v4N6"),Ke=a("TVEO");const Qe=Object(V.a)((e=>({root:{height:"100%",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"},content:{display:"flex",flexDirection:"column",alignItems:"center",gap:"20px"}})));var _e=a("TzxL"),Ye=a("2Ah+"),Je=a("AH+P"),Xe=a("lm3o"),Ze=a("rtnm"),et=a("kvDL");const tt=Object(V.a)((e=>({iconCell:{padding:0,fontSize:"16px",marginRight:"4px",height:"20px",width:"20px"},cellTitle:{display:"flex",alignItems:"center",gap:"4px",flexDirection:"row"},nameShow:{display:"flex",flexDirection:"row",gap:"4px",alignItems:"center",cursor:"pointer"},departmentList:{display:"inline-block"},nameField:{display:"flex",alignItems:"center",gap:"4px",flexDirection:"row"},hoverShowButton:{height:"100%",width:"100%",padding:"0",":hover,:focus-within":{color:e.palette.themePrimary}},hoverShowButtonContainer:{display:"none","*:hover > &, *:focus-within > &, *:hover > * > * > &, *:focus-within > * > * > &":{display:"flex",position:"relative",alignSelf:"flex-end",left:"20px"}},nameSpan:[Object(F.f)(1),{maxWidth:"160px"}],span:Object(F.f)(1),list:{"ms-DetailsRow":{cursor:"default"},".ms-Nav":{transition:"none !important"},"ms-DetailsHeader-cellTitle":{display:"flex",alignItems:"center",gap:"4px",flexDirection:"row"}}}))),at=({items:e,queryStatus:t,moduleName:a,departmentFullId:n,departmentMapping:i})=>{const r=tt(),[c,s]=Object(o.useState)(void 0),[d,m]=Object(o.useState)(void 0),[p,b]=Object(o.useState)(""),g=Object(u.i)(),{t:f}=Object(L.a)(),h=[{key:"name",name:f($.a.peopleListColumnForName),fieldName:"name",minWidth:264,maxWidth:264,isResizable:!1,iconName:"ContactCard",iconClassName:r.iconCell,className:r.cellTitle,onRender:e=>l.a.createElement("div",{className:r.nameField,key:e.id+"name"},l.a.createElement("div",{className:r.nameShow,onClick:t=>{b(e.id);const n=t.target;m(e),s(n),v.f.logUserBiAction(v.c.PeopleCard,v.d.OpenPeopleCard,a,{})}},l.a.createElement(_.a,{selection:{id:e.id,name:e.name,type:0},onRetrieveIcon:ie,coinSize:24}),l.a.createElement("div",{className:r.nameSpan,title:e.name},e.name)),l.a.createElement("div",{className:r.hoverShowButtonContainer},l.a.createElement(Re.a,{iconProps:{iconName:"Chat",styles:{root:{fontSize:"20px",":hover":{backgroundColor:"inherit"}}}},title:"Chat",ariaLabel:"Chat",className:r.hoverShowButton,onClick:()=>Me(e.id)}),l.a.createElement(Re.a,{iconProps:{iconName:"Call",styles:{root:{fontSize:"20px",padding:0}}},title:"Emoji",ariaLabel:"Emoji",className:r.hoverShowButton,onClick:()=>Le(e.id)})))},{key:"mail",name:f($.a.peopleListColumnForEmail),fieldName:"mail",minWidth:200,maxWidth:300,isResizable:!1,iconName:"Mail",iconClassName:r.iconCell,onRender:e=>l.a.createElement("div",{title:e.mail,className:r.span,key:e.id+"mail"},e.mail)},{key:"phone",name:f($.a.peopleListColumnForPhone),fieldName:"phone",minWidth:100,width:120,maxWidth:150,isResizable:!1,iconName:"Call",iconClassName:r.iconCell,onRender:e=>l.a.createElement("div",{title:e.phone,className:r.span,key:e.id+"phone"},e.phone)},{key:"depart",name:f($.a.peopleListColumnForDepart),fieldName:"depart",minWidth:200,maxWidth:300,isResizable:!1,iconName:"Location",iconClassName:r.iconCell,onRender:e=>{var t;const a={onRenderContent:()=>{var t;const a=[];return null===(t=e.parentDepartments)||void 0===t||t.forEach((e=>{var t,n;ne(null===(t=i[e])||void 0===t?void 0:t.departmentFullName)&&a.push(null===(n=i[e])||void 0===n?void 0:n.departmentFullName)})),l.a.createElement(l.a.Fragment,null,a&&1===a.length?l.a.createElement("div",{key:e.id+"departmentList"+a[0]},a[0]):l.a.createElement("ol",{style:{margin:"0 5px 0 0",padding:"0 0 0 14px"},key:e.id+"departmentListOL"+a[0]},a&&a.map((t=>l.a.createElement("li",{key:e.id+t},t)))))}},o=[];return null===(t=e.parentDepartments)||void 0===t||t.forEach((e=>{var t;ne(null===(t=i[e])||void 0===t?void 0:t.departmentFullName)&&o.push(e)})),l.a.createElement("div",{key:e.id+"tooltipHost"},l.a.createElement(Xe.a,{key:"tooltip"+e.id,tooltipProps:a,delay:Ze.a.zero,directionalHint:et.a.leftCenter},l.a.createElement("div",{key:"tooltipId"+e.id},i&&o&&o.map(((t,a)=>{var c,s,d,m;return l.a.createElement("div",{key:"tooltipId1"+e.id+t,className:r.departmentList},(null===(c=i[t])||void 0===c?void 0:c.departmentFullId)&&(null===(s=i[t])||void 0===s?void 0:s.departmentFullId)!==n?l.a.createElement(Ve.a,{key:i[t].departmentFullId,onClick:()=>{var e,a;return g(Object(D.b)(D.a.DepartmentTeam,void 0,{departmentFullName:null===(e=i[t])||void 0===e?void 0:e.departmentFullName,departmentFullId:null===(a=i[t])||void 0===a?void 0:a.departmentFullId}))}},ne(null===(d=i[t])||void 0===d?void 0:d.departmentFullName)):ne(null===(m=i[t])||void 0===m?void 0:m.departmentFullName),a!==o.length-1&&l.a.createElement("span",null,"; "))})))))}},{key:"role",name:f($.a.peopleListColumnForJob),fieldName:"role",minWidth:100,width:120,maxWidth:150,isResizable:!0,iconName:"Desk",iconClassName:r.iconCell,onRender:e=>l.a.createElement("div",{title:e.role,className:r.span,key:e.id+"role"},e.role)}];return l.a.createElement(l.a.Fragment,null,l.a.createElement(fe,{className:r.list,columns:h,items:e,queryStatus:t,shimmerLines:10}),void 0!==d&&d.id===p&&l.a.createElement(He,{key:d.id,departmentMapping:i,people:d,onDismiss:()=>b(""),target:c}))};var nt=a("1+It"),ot=a("oRLY");const lt=Object(ot.a)((e=>({container:{display:"flex",flexDirection:"column",gap:"24px",padding:"24px"}})));var it=function(e,t,a,n){return new(a||(a=Promise))((function(o,l){function i(e){try{c(n.next(e))}catch(e){l(e)}}function r(e){try{c(n.throw(e))}catch(e){l(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(i,r)}c((n=n.apply(e,t||[])).next())}))};function rt({onDismiss:e}){const[t,a]=l.a.useState(!0),{t:n}=Object(L.a)(),o=Object(u.i)(),i={headerProps:{title:"設定"},primaryBtnProps:{text:"離開",onClick:e},onDismiss:e,closeButtonAriaLabel:"離開"},{data:r,isLoading:c,error:s}=gt(te.c.getDepartmentCandidates,{},{}),[m,p]=l.a.useState(),b=l.a.useMemo((()=>r?r.map((e=>({key:e.id,text:e.name}))):[]),[r]);const{mutate:g,isSuccess:f,isLoading:v,error:h}=Object(d.useMutation)({mutationFn:()=>it(this,void 0,void 0,(function*(){m&&(yield te.c.setRootDepartment({departmentId:m}))})),onSuccess:()=>{te.g.clear(),Object(te.e)(),te.g.invalidateQueries(),e(),o(D.a.HomePage)}}),x=lt();return l.a.createElement(F.c,Object.assign({isOpen:t},i),l.a.createElement("div",{className:x.container},(c||v)&&l.a.createElement(Te,null),r&&!v&&!f&&l.a.createElement(l.a.Fragment,null,l.a.createElement(nt.a,{options:b,onChange:function(e,t){p(null==t?void 0:t.key)},label:"請選擇你的根部門",required:!0}),l.a.createElement(M.a,{text:"確認",onClick:()=>{g()},disabled:void 0===m})),f&&l.a.createElement("div",null,"設定成功"),h&&l.a.createElement("div",null,h),s&&l.a.createElement("div",null,s)))}const ct=Object(V.a)((e=>({root:{height:"100vh",overflowY:"hidden",backgroundColor:e.palette.neutralLighterAlt},topSearchSection:{display:"flex",justifyContent:"flex-end",padding:"5px 30px 5px 0"},peopleSection:Object.assign({display:"flex",alignItems:"stretch",backgroundColor:e.palette.white,height:"100%"},Object(K.f)(e.name)&&{borderTop:`1px solid ${e.palette.black}`,borderBottom:`1px solid ${e.palette.black}`}),peopleList:{height:"80%",overflowY:"auto",overflowX:"hidden"},navContainer:{display:"flex",flexDirection:"row",gap:"4px",alignItems:"center"},left:{flex:1,width:0,height:"100%",backgroundColor:e.palette.neutralLight,borderRight:`1px solid ${Object(K.f)(e.name)?e.palette.black:e.palette.neutralTertiaryAlt}`},main:{backgroundColor:e.palette.white,flex:4,width:0,gap:"20px",display:"flex",flexDirection:"column",padding:"24px",columnGap:"20px"},notPadding:{padding:"0px",margin:"0px"},breadcrumb:{fontSize:"24px"},dropdown:{width:"324px",".ms-Dropdown-caretDown":{fontSize:"16px",color:e.palette.neutralPrimary}}}))),st=e=>({chevronIcon:[{fontSize:"16px",left:"12px",top:"12px"},e.isExpanded&&{transform:""},!e.isExpanded&&{transform:"rotate(-90deg)"}],link:[{width:"100%",display:"flex",alignItems:"center"},Object(F.f)(1)],linkText:[{display:"flex",alignItems:"center",marginLeft:"6px",width:"100%"},Object(F.f)(1)],root:{overflowX:"hidden",height:"calc(100vh - 60px)",width:"100%"}});var dt;!function(e){e.AllMember="AllMember",e.DirectMember="DirectMember"}(dt||(dt={}));var mt=function(e,t){var a={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(a[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(a[n[o]]=e[n[o]])}return a};const pt=()=>{const e=ct(),{t:t}=Object(L.a)(),{params:a}=yt(),{departmentFullName:n,departmentFullId:i}=a,r=Object(u.i)(),c=[{key:dt.AllMember,text:t($.a.dropDownForDepartDefault)},{key:dt.DirectMember,text:t($.a.dropDownForDepartOption1)}],[s,d]=l.a.useState(dt.AllMember),{navLinkGroupsV2:m,departmentMapping:p,navDataTree:g,navDataError:f,loadingNav:h}=ft(n);console.log("navDataError",f);const x=i?function(e){var t;return null!==(t=null==e?void 0:e.split("/").pop())&&void 0!==t?t:""}(i):g&&g[0]&&g[0].id,E=(j=x,w=20,Nt("AllMember"===s?te.c.fetchGetAllUserMembersByDepartment:te.c.fetchGetDirectUserMembersByDepartment,{departmentId:j,top:w,skipToken:C},{enabled:!!j})),{data:y,error:N,isLoading:k}=E,O=mt(E,["data","error","isLoading"]);var j,w,C;const{data:S,isLoading:T}=gt(te.c.tokenExchangeVersion_Exchange,{input:{ResourceType:te.b.Graph,ResourceUrl:"https://graph.microsoft.com"}},{staleTime:1e3,cacheTime:1e3});Object(o.useEffect)((()=>{T||(console.log("accessToken:",S),console.log("isTokenValid:",ht(null==S?void 0:S.token)),(null==S?void 0:S.token)&&!ht(null==S?void 0:S.token)&&r(Object(D.b)(D.a.ConsentPage,{})))}),[S,T,r]),Object(o.useEffect)((()=>{var e,t;i&&""!==i||void 0===g||!(null===(e=g[0])||void 0===e?void 0:e.id)||!(null===(t=g[0])||void 0===t?void 0:t.name)||r(Object(D.b)(D.a.DepartmentTeam,void 0,{departmentFullName:g[0].name,departmentFullId:g[0].id}))}),[i,p,y,g,r]);const[F,R]=l.a.useState(!1),I=b.o.get(b.k.TenantId)||"",M=["a0783b62-a438-4df4-b01a-1922ce21ddbe","b6fa951c-a5e0-489a-aee6-b8d1c69cee47"].includes(I);return l.a.createElement("div",{className:e.root},l.a.createElement(Ue,{moduleName:v.b.HomePage,farItems:l.a.createElement("div",{className:e.navContainer},l.a.createElement(qe,null),M&&l.a.createElement(Re.a,{iconProps:{iconName:"Settings"},onClick:()=>{R(!0)}}),l.a.createElement(Ae,null))}),l.a.createElement("div",{className:e.peopleSection},l.a.createElement("div",{className:e.left},f&&l.a.createElement(U,{error:f}),h&&l.a.createElement(Te,null),m&&l.a.createElement(Ye.a,{ariaLabel:"",styles:st,groups:m,selectedKey:x,onLinkClick:(e,t)=>{null==e||e.preventDefault(),(null==t?void 0:t.url)&&r(t.url)}})),l.a.createElement("div",{className:e.main},l.a.createElement("h2",{className:e.notPadding},!h&&ne(null!=n?n:g&&g[0]&&g[0].name)),l.a.createElement("div",null,l.a.createElement(Je.a,{className:e.dropdown,placeholder:"Select an option",options:c,selectedKey:s,onChange:(e,t)=>{void 0!==t&&d(t.key)}})),l.a.createElement("div",{className:e.peopleList},y&&y.length>0&&p&&!h&&l.a.createElement(at,{items:y.map((e=>ae(e))),queryStatus:O,moduleName:v.b.HomePage,departmentFullId:i,departmentMapping:p}),0===(null==y?void 0:y.length)&&!h&&l.a.createElement(Oe,{title:t($.a.errorTitleForNotContract),message:t($.a.errorMessageForNotContract),img:"NoMessage"}),(k||h)&&l.a.createElement(Te,null),N&&l.a.createElement(U,{error:N})))),F&&l.a.createElement(rt,{onDismiss:()=>{R(!1)}}))},ut=Object(V.a)((e=>({root:{height:"100%",display:"flex",flexDirection:"column"},topSearchSection:{display:"flex",justifyContent:"flex-end",padding:"30px"},field:{flex:1,".ms-Label":{padding:"0 0 4px",whiteSpace:"nowrap"}},peopleSection:Object.assign({display:"flex",alignItems:"stretch",height:"100%"},Object(K.f)(e.name)&&{borderTop:`1px solid ${e.palette.black}`,borderBottom:`1px solid ${e.palette.black}`}),textFieldIcon1:{position:"absolute",left:"6px",top:"50%",transform:"translateY(-50%)",pointerEvents:"none"},inputField:{flex:1,".ms-Label":{padding:"0 0 4px",whiteSpace:"nowrap"},".ms-TextField-field":{paddingLeft:"36px",backgroundColor:e.palette.white,paddingRight:"36px"}},left:{flex:1,width:0,backgroundColor:e.palette.neutralLighterAlt,borderRight:`1px solid ${Object(K.f)(e.name)?e.palette.black:e.palette.neutralTertiaryAlt}`},main:{padding:"24px 80px 24px 80px",backgroundColor:e.palette.white,height:"100%",overflowY:"auto"},topText:{color:e.palette.black},top:{display:"flex",justifyContent:"space-between",alignItems:"center"},dropdown:{width:"200px",marginBottom:"20px"},iconCell:{padding:0,fontSize:"16px",marginRight:"4px",height:"16px",width:"16px"}})));var bt=function(e,t){var a={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(a[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(a[n[o]]=e[n[o]])}return a};function gt(e,t,a){return Object(d.useQuery)(Object.assign({queryFn:({queryKey:t,signal:a})=>t[1]?e(t[1],a):e(a),queryKey:[e.name,t]},a))}function ft(e){const t=Object(u.i)(),{data:a,isLoading:n,error:o}=gt(te.c.fetchDepartmentNavV2,{},{staleTime:12e4,cacheTime:18e5}),{navLinkGroupsV2:i,departmentMapping:r,navDataTree:c}=l.a.useMemo((()=>{if(!a)return{navLinkGroupsV2:[],departmentMapping:{},navDataTree:void 0};if(0===a.length)return t(Object(D.b)(D.a.EmptyPage,{})),{navLinkGroupsV2:[],departmentMapping:{},navDataTree:void 0};const n=function(e){const t=new Map,a=[];return e.forEach((e=>{t.set(e.id,e)})),e.forEach((e=>{var n;if(e.parentIds&&e.parentIds.length>0)for(const a of e.parentIds){const o=t.get(a);o&&!(null===(n=null==o?void 0:o.subDepartments)||void 0===n?void 0:n.some((t=>t.id===e.id)))&&(o.subDepartments||(o.subDepartments=[]),o.subDepartments.push(e))}else a.push(e)})),a}(a),o={};return{navLinkGroupsV2:a?[{links:n.map((t=>vt(t,"","",e,o)))}]:[],departmentMapping:o,navDataTree:n}}),[e,a,t]);return{navLinkGroupsV2:i,departmentMapping:r,navDataTree:c,loadingNav:n,navDataError:o}}function vt(e,t,a,n,o){const l=""===t?e.id:`${t}/${e.id}`,i=""===a?e.name:`${a}/${e.name}`;o[e.id]={departmentFullId:l,departmentFullName:i};return{name:e.name,url:Object(D.b)(D.a.DepartmentTeam,void 0,{departmentFullName:i,departmentFullId:l}),key:e.id,expandAriaLabel:e.name,isExpanded:null==n?void 0:n.includes(e.name),links:e.subDepartments?e.subDepartments.map((e=>vt(e,l,i,n,o))):void 0}}function ht(e){var t,a;if(!e)return!1;const n=Object(re.a)(e),o=null!==(a=null===(t=null==n?void 0:n.scp)||void 0===t?void 0:t.split(" "))&&void 0!==a?a:[];return Object(te.d)(o)}var xt=a("Ge+E"),Et=a("y5uQ");function yt(){const[e,t]=Object(p.b)();return Object(o.useMemo)((()=>({params:Object.fromEntries(e),setParams:t,reset:()=>t({},{replace:!0})})),[e,t])}function Nt(e,t,a){var n,o,l,i,r;const c=Object(d.useInfiniteQuery)(Object.assign({queryFn:({queryKey:t,signal:a,pageParam:n})=>{var o;const l=n?Object.assign(Object.assign({},t[1]),{skipToken:n}):null!==(o=t[1])&&void 0!==o?o:{};return e(l,a)},queryKey:[e.name,t],getNextPageParam:e=>{var a,n;return e.skipToken&&(null===(a=e.results)||void 0===a?void 0:a.length)>=(null!==(n=null==t?void 0:t.top)&&void 0!==n?n:10)?e.skipToken:void 0}},a));return Object.assign(c,{loadMore:()=>c.fetchNextPage(),canLoadMore:c.isFetched&&c.hasNextPage,totalCount:null===(l=null===(o=null===(n=c.data)||void 0===n?void 0:n.pages)||void 0===o?void 0:o[0])||void 0===l?void 0:l.totalRecordCount,data:null===(r=null===(i=c.data)||void 0===i?void 0:i.pages)||void 0===r?void 0:r.reduce(((e,t)=>e.concat(t.results)),[]).filter((e=>null!=e))})}const kt=[l.a.createElement(u.b,{key:D.a.HomePage,path:D.a.HomePage,element:l.a.createElement(pt,null)}),l.a.createElement(u.b,{key:D.a.SearchResults,path:D.a.SearchResults,element:l.a.createElement((()=>{const e=ut(),{t:t}=(e.textFieldIcon1,Object(L.a)()),{params:a}=yt(),{searchText:n}=a,[i,r]=Object(o.useState)(n),c=(l.a.useCallback(((e,t)=>{r(t||"")}),[]),Object(u.i)()),s=Nt(te.c.fetchSearchUser,{top:10,userDisplayName:n},{enabled:""!==n}),{data:d,error:m,isLoading:p}=s,b=bt(s,["data","error","isLoading"]),{departmentMapping:g}=ft("");return l.a.createElement("div",{className:e.root},l.a.createElement(Ue,{moduleName:v.b.SearchResult,searchText:n}),l.a.createElement("div",{className:e.main},l.a.createElement("div",{className:e.top},l.a.createElement("h2",{className:e.topText},t($.a.searchResultLabel,{searchResult:n})),l.a.createElement(I.a,{onClick:()=>c(D.a.DepartmentTeam),text:t($.a.exitSearchLabel)})),d&&d.length>0&&l.a.createElement(at,{items:d.map((e=>ae(e))),queryStatus:b,moduleName:v.b.SearchResult,departmentMapping:g}),0===(null==d?void 0:d.length)&&l.a.createElement(Oe,{title:t($.a.errorTitleForNotContract),message:t($.a.errorMessageForNotContract),img:"NoMessage"}),p&&l.a.createElement(Te,null),m&&l.a.createElement(U,{error:m})))}),null)}),l.a.createElement(u.b,{key:D.a.DepartmentTeam,path:D.a.DepartmentTeam,element:l.a.createElement(pt,null)}),l.a.createElement(u.b,{key:D.a.ConsentPage,path:D.a.ConsentPage,element:l.a.createElement((()=>{const e=b.o.get(b.k.TenantId),{t:t}=Object(L.a)();return function(){const e=Object(u.i)(),[t,a]=Object(o.useState)(5e3),[n,l]=Object(o.useState)(!0),{data:i,isLoading:r,error:c}=Object(d.useQuery)(["bound tokenExchangeVersion_Exchange",{input:{ResourceType:0,ResourceUrl:b.h}}],(()=>te.c.tokenExchangeVersion_Exchange({input:{ResourceType:te.b.Graph,ResourceUrl:b.h}})),{refetchInterval:t,refetchIntervalInBackground:!0,onSuccess:t=>{console.log("Data updated:",t.token),console.log("Data updated:",ht(t.token)),ht(t.token)&&(console.log("Token is valid, stop polling."),l(!1),e(Object(D.b)(D.a.DepartmentTeam,{}),{}))},onError:e=>{console.error("Error during polling:",e)},enabled:n})}(),l.a.createElement(l.a.Fragment,null,l.a.createElement(Ue,{moduleName:v.b.HomePage,farItems:l.a.createElement(Ae,null)}),l.a.createElement(Oe,{img:"Optimizing",title:t($.a.consentTitleLabel),message:t($.a.consentDescriptionLabel),actionText:t($.a.consentButtonLabel),onAction:()=>{const t=`${b.d}/${e}/oauth2/v2.0/authorize?client_id=${b.l}&response_type=code&scope=.default&response_mode=query&prompt=consent`;window.open(t,"_blank")}}))}),null)}),l.a.createElement(u.b,{key:D.a.EmptyPage,path:D.a.EmptyPage,element:l.a.createElement((()=>{const{t:e}=Object(L.a)(),t=Qe(),a=Object(u.i)(),n=l.a.createElement("span",null,l.a.createElement(Ke.a,{i18nKey:$.a.emptyDescriptionWithLinkLabel,style:{display:"inline-block"}},"There are no departments or members available to display. Please",l.a.createElement(Ve.a,{href:"https://learn.microsoft.com/en-us/exchange/address-books/hierarchical-address-books/enable-or-disable-hierarchical-address-books",target:"_blank",rel:"noreferrer"},"click here"),"to set them up"));return l.a.createElement(l.a.Fragment,null,l.a.createElement(Ue,{moduleName:v.b.HomePage,farItems:l.a.createElement(l.a.Fragment,null)}),l.a.createElement("div",{className:t.root},l.a.createElement(Oe,{img:"Optimizing",title:e($.a.emptyTitleLabel),hyperText:n,actionText:"刷新数据",onAction:()=>{te.g.clear(),Object(te.e)(),te.g.invalidateQueries(),a(Object(D.b)(D.a.HomePage))}})))}),null)}),l.a.createElement(u.b,{key:"*",path:"*",element:l.a.createElement((()=>{const e=window.location.href;return Object(o.useEffect)((()=>{v.f.logTraceWarning(v.a.Navigate,`Redirect to desktop default page. original url:${e}`)}),[e]),l.a.createElement(u.a,{to:D.a.DepartmentTeam,replace:!0})}),null)})];var Ot=a("TJux");const jt=Object(de.F)({width:"100%",height:"100%"});var wt=a("4YvN");Object(wt.a)(!1),r.a.render(l.a.createElement(_e.a,null,l.a.createElement(c.c,null,l.a.createElement((()=>{const e=function(e){var t;const a=Object(c.p)()||b.o.get(b.k.Theme),{i18n:n}=Object(L.a)(void 0,{useSuspense:!1}),l=n.resolvedLanguage||(null===(t=n.languages)||void 0===t?void 0:t[0]);return Object(o.useEffect)((()=>{if(b.q?document.body.style.backgroundColor="#F5F5F5":document.body.style.backgroundColor="transparent",a){v.f.logTraceInfo(v.a.AppBoot,`Rendered app host with theme: ${a}.`);const e=`is-${a}Theme`;return document.body.classList.add(e),()=>document.body.classList.remove(e)}}),[a]),Object(o.useMemo)((()=>{const t=Object(Et.a)(Object(c.e)(null!=a?a:""),e);if(l){const e="rtl"===$.b.dir();return Object(xt.c)(e),Object.assign(Object.assign({},t),{rtl:e})}return t}),[a,l,e])}();return l.a.useEffect((()=>(v.f.logTraceInfo(v.a.AppBoot,"Rendered app host"),()=>{v.f.logTraceInfo(v.a.AppBoot,"Closing the app host")})),[]),l.a.createElement(s.a,{theme:e,applyTo:"body",className:jt},l.a.createElement(l.a.Suspense,{fallback:l.a.createElement(Te,null)},l.a.createElement(j,null,l.a.createElement(d.QueryClientProvider,{client:te.g},l.a.createElement(he,null),l.a.createElement(p.a,{history:Ot.a},l.a.createElement(u.d,null,kt)),l.a.createElement(m.ReactQueryDevtools,{position:"bottom-right",styleNonce:b.i})))))}),null))),document.getElementById("root"),(()=>{v.f.markScenario(v.c.AppBoot,v.e.AppBootReactRendered),v.f.logTraceInfo(v.a.AppBoot,"React rendered desktop APP")}))}},[["JwtI","runtime~main","main~mobile.microsoft","main~mobile.fui","main.fui","assets~main","package~main~mobile","package~main","npm._fluentui~react-icons","npm.framer-motion","npm._fluentui~utilities","npm.react-dom","npm.lodash-es","npm.react-query","npm._internationalized~date","npm.axios","npm.i18next","featureRelatedFiles~main~mobile","vendors~main~mobile","vendors~main","main~mobile"]]]);